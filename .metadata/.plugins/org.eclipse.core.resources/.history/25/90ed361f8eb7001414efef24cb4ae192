var ui = require('UI');

var save = function(apiInfo){

	var db = Ti.Database.open('inTheatersDatabase');

	db.execute('CREATE TABLE IF NOT EXISTS inTheatersInfo (id INTEGER PRIMARY KEY, date TEXT, time TEXT, city TEXT)');

	db.execute('DELETE FROM inTheatersInfo');

	db.execute('INSERT INTO inTheatersInfo (date, time, city) VALUES (?, ?, ?)', apiInfo.date, apiInfo.time, apiInfo.city);

	read();

	db.close();
	
};

var read = function() {
	var db = Ti.Database.open('inTheatersDatabase');
	var dbRows = db.execute('SELECT * FROM inTheatersInfo');
	while (dbRows.isValidRow()) {
	var dbPost = {
		date : dbRows.fieldByName('date'),
		time : dbRows.fieldByName('time'),
		city : dbRows.fieldByName('city'),
	};
		dbRows.next();
	};
	dbRows.close();
	db.close();
	ui.buildUI(dbPost);
};




exports.save = save;
exports.read = read;
